# Node.js 18.18 ì´ìƒìœ¼ë¡œ ì„¤ì • (Prisma ìš”êµ¬ì‚¬í•­)
FROM node:18.18-alpine

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# package.jsonê³¼ lock íŒŒì¼ ë¨¼ì € ë³µì‚¬ â†’ ìºì‹œ í™œìš©
COPY package*.json ./

# ì˜ì¡´ì„± ì„¤ì¹˜
RUN npm install --production

# ğŸ”¥ prisma ìŠ¤í‚¤ë§ˆë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë³µì‚¬
COPY prisma ./prisma

# ë‚˜ë¨¸ì§€ ì†ŒìŠ¤ ë³µì‚¬
COPY . .

# Prisma client ìƒì„±
RUN npx prisma generate

# ì•± ë¹Œë“œ (NestJSë©´ build ìŠ¤í¬ë¦½íŠ¸ í¬í•¨ ì „ì œ)
RUN npm run build

# ì•± ì‹¤í–‰
CMD ["npm", "start"]
